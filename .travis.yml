language: java
jdk:
 - oraclejdk8
 - openjdk8
after_success:
  - mvn clean test jacoco:report coveralls:report
before_deploy:
  - mvn help:evaluate -N -Dexpression=project.version|grep -v '\['
  - export project_version=$(mvn help:evaluate -N -Dexpression=project.version|grep -v '\[')

## Create release in GitHub
deploy:
    provider: releases
    api_key:
        secure: 7a97fbf290ce667dcca7c4695f9b9197ebe7d24f
    file:
        - loguno-processor/target/loguno-processor-$project_version.jar
        - loguno-processor/target/loguno-processor-$project_version-sources.jar
    skip_cleanup: true
    on:
        repo: dimpon/loguno
    name: $project_version
